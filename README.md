
# NyaayAI

India's legal system faces a significant backlog of cases, highlighting the urgent need for accessible legal information. Leveraging artificial intelligence (AI) advancements, this project aims to develop an intelligent legal aid chatbot tailored to the Indian context. Despite progress, providing free access to Indian legal information remains complex. Catering to diverse audiences, including legal professionals and the public, this chatbot seeks to democratize access to legal knowledge, ultimately fostering a more equitable legal system.
## Problem Statement
The project seeks to tackle India's accessibility gap in legal information by creating a comprehensive solution. It involves three main components:

    1. Open-Source Large Language Model (LLM): Developing an accessible LLM to serve as the foundation for legal AI applications, as proprietary models are often inaccessible for non-commercial use.

    2. Fine-tuning on Indian Legal Data: Ensuring accuracy and relevance by fine-tuning the LLM on a corpus of Indian legal documents. Acquiring and preprocessing such data poses challenges.

    3. Retrieval Augmented Generation (RAG) and Vector Database: Enhancing the system's ability to provide accurate responses by combining the LLM with a vector database of legal documents. Developing an effective retrieval mechanism presents challenges.

Addressing these components will lead to the creation of a comprehensive, open-source legal aid chatbot tailored to the Indian context.

## Architecture
The proposed system integrates cutting-edge Natural Language Processing (NLP) technologies with various algorithms and neural network approaches to develop a chatbot tailored for legal assistance and information retrieval. 
The workflow begins with user queries submitted through Chainlit, a web-based interface optimized for hosting large language models. The chatbot then utilizes the nomic embedding model for word embedding and tokenization, retrieving relevant information from a vector database using the Retrieval-Augmented Generation (RAG) mechanism. Simultaneously, semantic analysis is performed using an open-source Large Language Model. The chatbot generates responses tailored to the user's query by combining user query analysis with retrieved information.

For dataset creation and acquisition, legal documents such as the Indian Penal Code (IPC), Constitution of India, and Code of Criminal Procedure (CrPC) were utilized for RAG, while question-answer pairs from open-source datasets were used for optimizing the base Large Language Model (LLM). Additionally, custom-generated data covered specialized legal scenarios to fine-tune the chatbot's performance.

The system relies on an open-source Large Language Model, specifically Google’s Gemma, known for its natural language understanding and generation capabilities. Transformer architectures form the basis, allowing efficient sequential data processing through attention mechanisms. The system also integrates the Retrieval-Augmented Generation (RAG) method, combining retrieval-based and generative-based models to enhance performance.

Chroma DB serves as the vector storage system, efficiently storing and retrieving document embeddings. It supports semantic search engines and enables quick access to stored data from legal documents. The system also employs the nomic embedding model for training advanced methods to handle complex language, and optimization techniques such as Parameter Efficient Fine-Tuning (PEFT), Low-Rank Adaptation (LORA), and Quantized Low-Rank Adaptation (QLORA) are used to enhance performance and efficiency.

Overall, the proposed architecture combines state-of-the-art NLP technologies, advanced algorithms, and efficient data storage mechanisms to develop a chatbot capable of providing accurate and tailored legal assistance and information retrieval.
## Results 

The initial interface of the NyaayAI chatbot aimed to provide a user-friendly experience for
individuals with varying levels of legal knowledge. While the initial interface offered essential
functional expertise, there was room for improvement in the depth and clarity of the chatbot's
responses and the overall user experience.

    5.1 Pre-Optimization
        The figure below illustrates the response generated by the chatbot before any optimization or
        fine-tuning processes were implemented. Hallucinations and inaccuracies characterize the
        unoptimized chatbot's response.

    5.2 Optimization 

    5.3 Post Optimization
        After the optimization process, which involved fine-tuning the language model, integrating the
        Retrieval-Augmented Generation (RAG) component, and incorporating user feedback, the
        content of the NyaayAI chatbot interface was significantly enhanced. The optimized interface
        content, coupled with the improved performance of the fine-tuned language model and the
        RAG system, aimed to provide users with accurate, co

## Future Scope

Within the ever-evolving domain of legal assistance technology, the future of our legal chatbot
using RAG Optimization assures more significant improvements in improving and enhancing
its efficiency, scalability, and functionality. Building upon the current capabilities of the
model, future work for this project involves using relevant, optimized techniques and
technologies to advance legal services. The following are some of the noted improvements on
the current proposed system:

    1.Efficiency and Scalability:
        a. Use various techniques to create optimized smaller and faster RAG versions.
        b. Reduce required computational memory and resource utilization by using
        compression models.
    2.Multi-modal Capabilities:
        a. Diversify input methods by allowing text, audio, and visual interactions to improve
        the chatbot’s versatility.
        b. Allow users to upload documents or images regarding legal queries, allowing the
        chatbot to analyze and aid.
    3.Integration with Legal Research Tools:
        a. Access updated legal precedents, laws, and decrees by linking to legal research
        platforms.
        b. Enhance the chatbot’s knowledge base by linking to legal databases, citation
        systems, and repositories.
    4.Legal Document Generation and Review:
        a. Additional functionality to generate legal documents like contracts, agreements, or
        letters based on defined user specifications.
        b. Work with NLG techniques to draft documents and review compliance and accuracy.
